// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Users {
  uuid            String     @id @default(uuid())
  profile_picture String
  display_name    String
  username        String     @unique
  password        String
  email           String     @unique
  phone           String?    @unique
  about           String?
  Messages        Messages[]
  Channels        Channels?  @relation(fields: [channelsUuid], references: [uuid])
  channelsUuid    String?
}

// A message has a UUID so we can respond to it, it has a type to know if it's a multimedia, it has a created_at and a seen_at. Each message must
// have a sender, and a channel, so we can know where it's from and where it's going.

model Messages {
  uuid       String    @id @default(uuid())
  type       String
  created_at DateTime  @default(now())
  seen_at    DateTime?
  sender     Users     @relation(fields: [sender_id], references: [uuid])
  sender_id  String
  channel    Channels  @relation(fields: [channel_id], references: [uuid])
  channel_id String
  text       String?
  multimedia String?
}

// a channel must have a uuid so we can manipulate it's data, it must have an array of users so we can know who is in the channel, it must have a name
// and it must have a type so we know if it's a 1to1 communication or a group communication.

model Channels {
  uuid       String     @id @default(uuid())
  users      Users[]
  name       String
  type       String
  created_at DateTime   @default(now())
  updated_at DateTime   @updatedAt
  messages   Messages[]
}

model User_s_Channel {
  uuid         String @id @default(uuid())
  user_uuid    String
  channel_uuid String
}
